---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

Set locale to English and load ggplot2 library
```{r}
library(ggplot2)
Sys.setlocale("LC_TIME", "C")
```

## Loading and preprocessing the data
```{r}
if (!file.exists("activity.csv")) {
    unzip("activity.zip")
}
activity <- read.csv("activity.csv")
```


## What is mean total number of steps taken per day?
```{r}
steps <- tapply(activity$steps, activity$date, function(x) sum(x, na.rm = TRUE))
hist(steps)
mean(steps)
median(steps)
```


## What is the average daily activity pattern?
```{r}
interval_steps <- tapply(activity$steps, activity$interval, function(x) mean(x, na.rm = TRUE))
plot(interval_steps, type = "l")
names(which(interval_steps == max(interval_steps)))
```


## Imputing missing values

The strategy is to take the mean of a 5-minute interval and assign it to a missing value in that interval.

```{r}
sum(is.na(activity))
activity_full <- activity
sum(is.na(activity_full))
for (i in 1 : nrow(activity_full)) {
    if (is.na(activity_full$steps[i])) {
        activity_full$steps[i] <- interval_steps[as.character(activity_full$interval[i])]
    }
}
sum(is.na(activity_full))

steps_full <- tapply(activity_full$steps, activity_full$date, function(x) sum(x, na.rm = TRUE))
hist(steps_full)
mean(steps_full)
median(steps_full)
```

Yes, they differ because less steps get taken into account. With missing values, there will be less steps for each day.


## Are there differences in activity patterns between weekdays and weekends?
```{r}
daytype <- vector("integer")
for (i in 1 : nrow(activity_full)) {
    if (is.element(weekdays(as.Date(activity_full$date[i])), c("Saturday", "Sunday"))) {
        daytype[i] <- 1
    } else {
        daytype[i] <- 0
    }
}
activity_full$daytype <- factor(daytype, labels = c("weekday", "weekend"))
qplot(activity_full$interval, activity_full$steps, activity_full, facets = . ~ daytype, geom = "line")

```